var cos,pig,spaceKey,jumpSound,falling,getStarSound,loseLifeSound,leftarrow,rightarrow,heart,background,textLives,randomNumberSecond,testAnimationInstance,timer,scoreText,levelText,totalScoreText,getItem,points,machines,spacekey,hearts,stars,game=new Phaser.Game(1820,600,Phaser.CANVAS,"game",{preload:preload,create:create,update:update,render:render}),len=1,startCounter=3,machinesSpeed=4,totalTime=0,lives=3,score=0,totalScore=0,level=1,progressStarPos=350,fontColor="#25A2F4",Table=new Array("1","2","3"),bodyVel=-200,bgVel=2,levelPoints=0,timeSinceLastIncrement=0;function init(){game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.pageAlignHorizontally=!0,game.scale.pageAlignVertically=!0,game.scale.setScreenSize(!0),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=100}function preload(){init(),this.load.spritesheet("pig","https://rawgit.com/MEJSIK/Game/master/pig.png",108,60,6),this.load.spritesheet("mach1","https://rawgit.com/MEJSIK/Game/master/mach1.png",400,450,53),this.load.spritesheet("mach2","https://rawgit.com/MEJSIK/Game/master/mach2.png",500,500,16),this.load.spritesheet("mach3","https://rawgit.com/MEJSIK/Game/master/mach3.png",650,411,6),this.load.spritesheet("mach4","https://rawgit.com/MEJSIK/Game/master/mach4.png",500,500,56),this.load.spritesheet("mach5","https://rawgit.com/MEJSIK/Game/master/mach5.png",300,449,12),this.load.image("mach6","https://rawgit.com/MEJSIK/Game/master/mach6.png"),this.load.image("mach7","https://rawgit.com/MEJSIK/Game/master/mach7.png"),this.load.image("mach8","https://rawgit.com/MEJSIK/Game/master/mach8.png"),this.load.image("mach9","https://rawgit.com/MEJSIK/Game/master/mach9.png"),this.load.image("background","https://rawgit.com/MEJSIK/Game/master/Asset%205.png"),this.load.image("heart","https://rawgit.com/MEJSIK/Game/master/heart.png"),this.load.image("star","https://rawgit.com/MEJSIK/Game/master/starImg.png"),game.load.audio("jump","https://rawgit.com/MEJSIK/Game/master/flyUp.mp3"),game.load.audio("falling","https://rawgit.com/MEJSIK/Game/master/endLife.mp3"),game.load.audio("getStar","https://rawgit.com/MEJSIK/Game/master/getStar.mp3"),game.load.audio("loseLife","https://rawgit.com/MEJSIK/Game/master/loseLive.mp3")}function create(){switch(game.physics.startSystem(Phaser.Physics.ARCADE),game.world.setBounds(0,0,1820,600),(spacekey=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)).onDown.add(jump,this),leftarrow=game.input.keyboard.addKey(Phaser.Keyboard.LEFT),rightarrow=game.input.keyboard.addKey(Phaser.Keyboard.RIGHT),background=this.add.tileSprite(0,0,this.stage.bounds.width,this.cache.getImage("background").height,"background"),this.game.physics.arcade.enable(background),background.body.allowGravity=!1,(pig=this.add.sprite(60,this.world.centerY,"pig")).animations.add("fly"),pig.animations.play("fly",20,!0),pig.anchor.setTo(.5,.5),this.game.physics.enable(pig,Phaser.Physics.ARCADE),pig.body.setSize(70,40,15,0),pig.body.enable=!0,pig.body.bounce.setTo(1,1),pig.body.collideWorldBound=!0,pig.alpha=1,pig.body.gravity.y=1e3,machines=game.add.group(),level){case 1:randomNumberSecond=game.rnd.integerInRange(600,1500)}setInterval(createStar,randomNumberSecond),machines.enableBody=!0,machines.physicsBodyType=Phaser.Physics.ARCADE,machines.callAll("anchor.setTo","anchor",.5),machines.callAll("scale.setTo","scale",.7),machines.callAll("animations.add","move",null,7,!0,!0),machines.callAll("play",null,"move"),(stars=game.add.group()).enableBody=!0;var e=game.add.graphics(0,0);e.beginFill(2761796),e.moveTo(0,0),e.lineTo(1820,0),e.lineTo(1820,100),e.lineTo(0,100),e.lineTo(0,0),e.endFill(),window.graphics=e;var a=game.add.graphics(0,0);a.beginFill(15747067),a.lineStyle(2,13280,1),a.moveTo(64,55),a.lineTo(700,55),a.endFill(),window.graphics=a,scoreText=game.add.text(170,16,"0",{fontSize:"32px",fill:fontColor}),totalScoreText=game.add.text(300,16,"TOTAL SCORE: 0",{fontSize:"32px",fill:fontColor}),levelText=game.add.text(game.world.centerX-50,50,"Level "+level,{fontSize:"120",fill:"#fff"}),game.add.sprite(64,16,"heart").scale.setTo(.3),game.add.sprite(128,16,"star").scale.setTo(.1),textLives=game.add.text(85,25,"x"+lives,{fontSize:"16px",fill:fontColor}),this.jumpSound=game.add.audio("jump"),this.jumpSound.volume=.2,this.getStarSound=game.add.audio("getStar"),this.getStarSound.volume=.2,this.loseLifeSound=game.add.audio("loseLife"),this.loseLifeSound.volume=.2}function updateCounter(){totalTime++,console.log(totalTime),totalTime%2==0&&(pig.body.setSize(70,40,15,1),timer.stop())}function update(){game.input.onDown.add(jump,this),leftarrow.isDown?pig.x-=2:rightarrow.isDown&&(pig.x+=2),background.tilePosition.x-=bgVel,pig.angle<20&&(pig.angle+=1),pig.y>600&&(this.loseLifeSound.play(),lives--,opacityAnimation(),lives<0?(game.paused=!0,restartGame()):(textLives.setText("x"+lives),pig.y=100)),(timeSinceLastIncrement+=game.time.elapsed)>=2e3&&(timeSinceLastIncrement=0,createMachine()),game.physics.arcade.overlap(pig,stars,collisionHandler,null,this),game.physics.arcade.overlap(pig,machines,function(){pig.body.setSize(10,10,0,-700),(timer=game.time.create(!1)).loop(1500,updateCounter,this),timer.start(),this.loseLifeSound.play(),opacityAnimation(),pig.y=100,--lives<0&&(game.paused=!0,restartGame());textLives.setText("x"+lives)},null,this),machines.x-=machinesSpeed}function render(){machines.forEach(this.game.debug.body,this.game.debug),game.debug.body(pig)}function createMachine(){switch(game.rnd.integerInRange(0,8)){case 0:(e=machines.create(game.width*len*.5,100,"mach1",0)).body.setSize(380,100,10,0),len++;break;case 1:(e=machines.create(game.width*len*.5,250,"mach2",0)).body.setSize(230,300,90,150),e.scale.setTo(.7),e.animations.add("move",null,7,!0,!0),e.animations.play("move",!0),len++;break;case 2:(e=machines.create(game.width*len*.5,320,"mach3",0)).body.setSize(400,300,80,70),e.scale.setTo(.7),e.animations.add("move",null,7,!0,!0),e.animations.play("move",!0),len++;break;case 3:(e=machines.create(game.width*len*.5,250,"mach4",0)).body.setSize(300,400,60,50),e.scale.setTo(.7),e.animations.add("move",null,7,!0,!0),e.animations.play("move",!0),len++;break;case 4:(e=machines.create(game.width*len*.5,300,"mach5",0)).body.setSize(180,350,40,45),e.scale.setTo(.7),e.animations.add("move",null,7,!0,!0),e.animations.play("move",!0),len++;break;case 5:(e=machines.create(game.width*len*.5,350,"mach6",0)).body.setSize(100,350,25,5),len++;break;case 6:(e=machines.create(game.width*len*.5,100,"mach7",0)).body.setSize(40,20,40,20),e.scale.setTo(3),len++;break;case 7:(e=machines.create(game.width*len*.5,440,"mach8",0)).body.setSize(50,50),e.scale.setTo(3),len++;break;case 8:var e;(e=machines.create(game.width*len*.5,300,"mach9",0)).body.setSize(100,100,0,20),e.scale.setTo(3),len++;break;default:len++}}function createStar(){var e=stars.create(game.width,150+game.world.randomY-150,"star");e.scale.setTo(.2),moveIndividual(e)}function moveIndividual(e){e.body.velocity.x=bodyVel}function collisionHandler(e,a){this.getStarSound.play(),a.kill(),score+=10,totalScore+=10,scoreText.setText(score),totalScoreText.setText("TOTAL SCORE:"+totalScore),score>=50*level&&(level++,levelText.setText("Level"+level),bodyVel-=200,bgVel*=2,machinesSpeed+=2,score=0)}function jump(){this.jumpSound.play(),pig.body.velocity.y=-350,game.add.tween(pig).to({angle:-20},100).start()}function restartGame(){game.input.keyboard.onUpCallback=function(e){this.game.input.onDown.add(function(){game.paused=!1,game.state.restart(),lives=3,level=1,bodyVel=-500,bgVel=2,totalScore=0,score=0,machines.x=0,machines.foreach(remove.this)}),13==e.keyCode&&(game.paused=!1,game.state.restart(),lives=3,level=1,bodyVel=-500,bgVel=2,totalScore=0,score=0,machines.x=0,machines.foreach(remove.this))}}function opacityAnimation(){game.add.tween(pig).to({alpha:.2},2e3,Phaser.Easing.Bounce.Out,!0,0,1,!0).yoyo(!0,3e3)}
